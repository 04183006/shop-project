{"remainingRequest":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\src\\views\\home\\Home.vue?vue&type=style&index=0&id=3dd2e005&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\src\\views\\home\\Home.vue","mtime":1582030126852},{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKI2hvbWUgewogIGhlaWdodDogMTAwdmg7CiAgcG9zaXRpb246IHJlbGF0aXZlOwp9Ci5ob21lLW5hdiB7CiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3ItdGludCk7CiAgY29sb3I6IHdoaXRlOwogIHotaW5kZXg6IDI7Cn0KLnRhYi1jb250cm9sIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgei1pbmRleDogMzsKfQoKLmNvbnRlbnR7CiAgcG9zaXRpb246YWJzb2x1dGU7CiAgb3ZlcmZsb3c6IGhpZGRlbjsKICB0b3A6IDQ0cHg7CiAgYm90dG9tOiA0OXB4OwogIGxlZnQ6IDA7CiAgcmlnaHQ6IDA7Cn0KCi5maWV4ZHsKICBwb3NpdGlvbjogZml4ZWQ7CiAgbGVmdDogMDsKICByaWdodDogMDsKICB0b3A6IDQ0cHg7Cn0K"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views/home","sourcesContent":["<template>\n  <div id=\"home\">\n    <nav-bar class=\"home-nav\">\n      <div slot=\"center\">购物街</div>\n    </nav-bar>\n    <tab-control :titles=\"['流行','新款','精选']\" @tabClick=\"tabClick\" ref=\"tabControl1\" \n    v-show=\"isFixed\"  class=\"tab-control\" :class=\"{fiexd:isFixed}\"></tab-control>\n    <b-scroll class=\"content\" ref=\"scroll\"\n     :probe-type='3' \n     @scroll=\"contentScroll\"\n     :pull-up-load='true'\n     @pullingUp=\"loadMore\">\n      <home-swiper :banners=\"banners\" @swiperImageLoad=\"swiperImage\"></home-swiper>\n      <recommend-view :recommends=\"recommends\"></recommend-view>\n      <feature-view></feature-view>\n      <tab-control :titles=\"['流行','新款','精选']\" @tabClick=\"tabClick\" ref=\"tabControl2\"></tab-control>\n      <goods-list :goods=\"showGoods\"></goods-list>\n    </b-scroll>\n    <back-top @click.native=\"backTop\" v-show=\"isShow\"></back-top>\n  </div>\n</template>\n\n<script>\nimport NavBar from \"components/common/navbar/NavBar\";\n\nimport HomeSwiper from \"./childComps/HomeSwiper\";\n\nimport RecommendView from \"./childComps/RecommendView\";\n\nimport FeatureView from \"./childComps/FeatureView\";\n\nimport TabControl from \"components/content/tabControl/TabControl\";\n\nimport GoodsList from \"components/content/goods/GoodsList\";\n\nimport BScroll from \"components/common/scroll/Scroll\";\n\nimport BackTop from 'components/content/backTop/BackTop'\n\nimport { getHomeMultidata, getHomeGoods } from \"network/home\";\n\nimport {debounce} from 'common/utils'\nexport default {\n  name: \"Home\",\n  data() {\n    return {\n      banners: [{}, {}, {}, {}],\n      recommends: [],\n      currentType: \"pop\",\n      scroll: null,\n      isShow:false,\n      tabOffsetTop:0,\n      isFixed:false,\n      saveY:'',\n      goods: {\n        pop: { page: 0, list: [] },\n        new: { page: 0, list: [] },\n        sell: { page: 0, list: [] }\n      }\n    };\n  },\n  components: {\n    NavBar,\n    HomeSwiper,\n    RecommendView,\n    FeatureView,\n    TabControl,\n    GoodsList,\n    BScroll,\n    BackTop\n  },\n  activated(){\n    console.log(this.saveY);\n    this.$refs.scroll.scrollTo(0, this.saveY, 0);\n    this.$refs.scroll.refresh();\n  },\n  deactivated(){\n    this.saveY = this.$refs.scroll.getScrollY();\n    console.log(this.saveY)\n  },\n  created() {\n    //1.请求多个数据（主要是轮播图和下面的数据）\n    this.getHomeMultidata();\n\n    //2.请求下面的商品数据\n    this.getHomeGoods(\"pop\");\n    this.getHomeGoods(\"new\");\n    this.getHomeGoods(\"sell\");\n  }, \n   mounted() {\n    //1.监听item图片加载完成\n    const refresh = debounce(this.$refs.scroll.refresh,500)\n    this.$bus.$on(\"itemImageLoad\", () => {\n      refresh()\n    });\n  },\n  methods: {\n    \n\n    /**\n     * 事件监听相关方法\n     */\n    tabClick(index) {\n      switch (index) {\n        case 0:\n          this.currentType = \"pop\";\n          break;\n        case 1:\n          this.currentType = \"new\";\n          break;\n        case 2:\n          this.currentType = \"sell\";\n          break;\n      }\n\n      //这样实现给两个tabControl保持一致\n      this.$refs.tabControl1.currentIndex = index;\n      this.$refs.tabControl1.currentIndex = index;\n    },\n    swiperImage(){\n         //2.获取tabControl的offesetTop\n    this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;\n    },\n    /**\n     * 网络请求相关方法\n     */\n    getHomeMultidata() {\n      getHomeMultidata().then(res => {\n        // console.log(res);\n        //处理数据\n        this.banners = res.data.banner.list; //将请求的数据存储起来，避免被垃圾回收\n        this.recommends = res.data.recommend.list;\n      });\n    },\n    getHomeGoods(type) {\n      const page = this.goods[type].page + 1; //请求下一页\n      getHomeGoods(type, page).then(res => {\n        // console.log(res)  //pop 第一页的前30条数据\n        // console.log(res.data.list)\n        this.goods[type].list.push(...res.data.list);\n        this.goods[type].page += 1;\n        //多了一组数据就要page+1\n        // console.log(this.goods);\n      });\n    },\n    /**\n     * 返回顶部backtop函数\n     */\n    backTop(){\n      // console.log('backTop');\n      this.$refs.scroll.scrollTo(0,0)\n    },\n    contentScroll(position){\n      //1.判断backTop是否显示\n      //大于1000设置为true，小于1000设置为false\n      this.isShow = (-position.y) > 1000;\n\n      //2.判断tabControl是否吸顶效果{position:fiexd;}\n      this.isFixed = (-position.y) > this.tabOffsetTop;\n\n    },\n\n     /**\n   * 上拉加载更多\n   */\n    loadMore(){\n      // console.log('上拉加载更多')\n      this.getHomeGoods(this.currentType);\n      // console.log(this.goods.new.page);\n      this.$refs.scroll.finishedPullUp();\n    }\n  },\n\n \n  computed: {\n    showGoods() {\n      return this.goods[this.currentType].list;\n    }\n  }\n};\n</script>\n\n<style scoped>\n#home {\n  height: 100vh;\n  position: relative;\n}\n.home-nav {\n  background-color: var(--color-tint);\n  color: white;\n  z-index: 2;\n}\n.tab-control {\n  position: relative;\n  z-index: 3;\n}\n\n.content{\n  position:absolute;\n  overflow: hidden;\n  top: 44px;\n  bottom: 49px;\n  left: 0;\n  right: 0;\n}\n\n.fiexd{\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 44px;\n}\n</style>\n"]}]}