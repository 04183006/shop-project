{"remainingRequest":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\src\\views\\detail\\Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\src\\views\\detail\\Detail.vue","mtime":1582444629760},{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86156\\Desktop\\Web - VUE\\Vue project\\vue-project\\vue-project\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRGV0YWlsTmF2QmFyIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxOYXZCYXIiOw0KaW1wb3J0IERldGFpbEJvdHRvbUJhciBmcm9tICIuL2NoaWxkQ29tcHMvRGV0YWlsQnV0dG9uYmFyIjsNCmltcG9ydCBEZXRhaWxTd2lwZXIgZnJvbSAiLi9jaGlsZENvbXBzL0RldGFpbFN3aXBlciI7DQppbXBvcnQgRGV0YWlsQmFzZUluZm8gZnJvbSAiLi9jaGlsZENvbXBzL0RldGFpbEJhc2VJbmZvIjsNCmltcG9ydCBEZXRhaWxTaG9wSW5mbyBmcm9tICIuL2NoaWxkQ29tcHMvRGV0YWlsU2hvcEluZm8iOw0KaW1wb3J0IERldGFpbEdvb2RzSW5mbyBmcm9tICIuL2NoaWxkQ29tcHMvRGV0YWlsR29vZHNJbmZvIjsNCmltcG9ydCBTY3JvbGwgZnJvbSAiY29tcG9uZW50cy9jb21tb24vc2Nyb2xsL1Njcm9sbCI7DQppbXBvcnQgRGV0YWlsUGFyYW1JbmZvIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxQYXJhbUluZm8iOw0KaW1wb3J0IERldGFpbENvbW1lbnRJbmZvIGZyb20gIi4vY2hpbGRDb21wcy9EZXRhaWxDb21tZW50SW5mbyI7DQppbXBvcnQgR29vZHNMaXN0IGZyb20gImNvbXBvbmVudHMvY29udGVudC9nb29kcy9Hb29kc0xpc3QiOw0KaW1wb3J0IEJhY2tUb3AgZnJvbSAiY29tcG9uZW50cy9jb250ZW50L2JhY2tUb3AvQmFja1RvcCI7DQppbXBvcnQgeyBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCcNCmltcG9ydCB7IGl0ZW1MaXN0ZW5lck1peGluLCBiYWNrVG9wTWl4aW4gfSBmcm9tICJjb21tb24vbWl4aW4iOw0KaW1wb3J0IHsNCiAgZ2V0RGV0YWlsLA0KICBHb29kcywNCiAgU2hvcCwNCiAgR29vZHNQYXJhbSwNCiAgZ2V0UmVjb21tZW5kDQp9IGZyb20gIm5ldHdvcmsvZGV0YWlsIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIkRldGFpbCIsDQogIG1peGluczogW2l0ZW1MaXN0ZW5lck1peGluLCBiYWNrVG9wTWl4aW5dLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBkYXRhOiAiIiwNCiAgICAgIGlpZDogbnVsbCwNCiAgICAgIHJlczogbnVsbCwNCiAgICAgIHRvcEltYWdlczogW10sDQogICAgICBnb29kczoge30sDQogICAgICBzaG9wOiB7fSwNCiAgICAgIGRldGFpbEluZm86IHt9LA0KICAgICAgcGFyYW1JbmZvOiB7fSwNCiAgICAgIGNvbW1lbnRJbmZvOiB7fSwNCiAgICAgIHJlY29tbWVuZHM6IFtdLA0KICAgICAgdGhlbWVUb3BZczogW10sDQogICAgICBjdXJyZW50SW5kZXg6IDAsDQogICAgICBpc0ZpeGVkOiBmYWxzZQ0KICAgIH07DQogIH0sDQogIGNvbXBvbmVudHM6IHsNCiAgICBEZXRhaWxOYXZCYXIsDQogICAgRGV0YWlsU3dpcGVyLA0KICAgIERldGFpbEJhc2VJbmZvLA0KICAgIERldGFpbFNob3BJbmZvLA0KICAgIFNjcm9sbCwNCiAgICBEZXRhaWxHb29kc0luZm8sDQogICAgRGV0YWlsUGFyYW1JbmZvLA0KICAgIERldGFpbENvbW1lbnRJbmZvLA0KICAgIEdvb2RzTGlzdCwNCiAgICBEZXRhaWxCb3R0b21CYXIsDQogICAgQmFja1RvcA0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIC8vMS7ojrflj5ZpaWQNCiAgICB0aGlzLmlpZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmlpZDsNCg0KICAgIC8vMi7moLnmja5paWTojrflj5bmlbDmja4NCiAgICBnZXREZXRhaWwodGhpcy5paWQpLnRoZW4ocmVzID0+IHsNCiAgICAgIC8vMy7mir3nprvor6bmg4XpobXmlbDmja4NCiAgICAgIC8vIGNvbnNvbGUubG9nKHJlcyk7DQogICAgICBjb25zdCBkYXRhID0gcmVzLnJlc3VsdDsNCiAgICAgIC8vMS7ojrflj5bpobbpg6jova7mkq3mlbDmja4NCiAgICAgIHRoaXMudG9wSW1hZ2VzID0gZGF0YS5pdGVtSW5mby50b3BJbWFnZXM7DQogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnRvcEltYWdlcykNCg0KICAgICAgLy8yLuiOt+WPluWVhuWTgeS/oeaBrw0KICAgICAgdGhpcy5nb29kcyA9IG5ldyBHb29kcygNCiAgICAgICAgZGF0YS5pdGVtSW5mbywNCiAgICAgICAgZGF0YS5jb2x1bW5zLA0KICAgICAgICBkYXRhLnNob3BJbmZvLnNlcnZpY2VzDQogICAgICApOw0KDQogICAgICAvLzMu6I635Y+W5ZWG5a625L+h5oGvDQogICAgICB0aGlzLnNob3AgPSBuZXcgU2hvcChkYXRhLnNob3BJbmZvKTsNCg0KICAgICAgLy80LuS/neWtmOWVhuWTgeeahOivpuaDheaVsOaNrg0KICAgICAgdGhpcy5kZXRhaWxJbmZvID0gZGF0YS5kZXRhaWxJbmZvOw0KDQogICAgICAvLzUu6I635Y+W5Y+C5pWw5L+h5oGvDQogICAgICB0aGlzLnBhcmFtSW5mbyA9IG5ldyBHb29kc1BhcmFtKA0KICAgICAgICBkYXRhLml0ZW1QYXJhbXMuaW5mbywNCiAgICAgICAgZGF0YS5pdGVtUGFyYW1zLnJ1bGUNCiAgICAgICk7DQoNCiAgICAgIC8vNi7ojrflj5bor4Torrrkv6Hmga8NCiAgICAgIGlmIChkYXRhLnJhdGUuY1JhdGUgIT09IDApIHsNCiAgICAgICAgdGhpcy5jb21tZW50SW5mbyA9IGRhdGEucmF0ZS5saXN0WzBdOw0KICAgICAgfQ0KDQogICAgICAvLzcu6K+35rGC5o6o6I2Q5pWw5o2uDQogICAgICBnZXRSZWNvbW1lbmQoKS50aGVuKHJlcyA9PiB7DQogICAgICAgIHRoaXMucmVjb21tZW5kcyA9IHJlcy5kYXRhLmxpc3Q7DQogICAgICB9KTsNCiAgICB9KTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC4uLm1hcEFjdGlvbnMoWydhZGRDYXJ0J10pLA0KICAgIC8qKg0KICAgICAqIOi/lOWbnumhtumDqGJhY2t0b3Dlh73mlbANCiAgICAgKi8NCiAgICB0aXRsZUNsaWNrKGluZGV4KSB7DQogICAgICAvLyBjb25zb2xlLmxvZyhpbmRleCkNCiAgICAgIHRoaXMuJHJlZnMuc2Nyb2xsLnNjcm9sbFRvKDAsIC10aGlzLnRoZW1lVG9wWXNbaW5kZXhdLCA1MDApOw0KICAgIH0sDQogICAgaW1hZ2VMb2FkKCkgew0KICAgICAgdGhpcy4kcmVmcy5zY3JvbGwucmVmcmVzaCgpOw0KICAgICAgdGhpcy50aGVtZVRvcFlzLnB1c2goMCk7DQogICAgICB0aGlzLnRoZW1lVG9wWXMucHVzaCh0aGlzLiRyZWZzLnBhcmFtcy4kZWwub2Zmc2V0VG9wKTsNCiAgICAgIHRoaXMudGhlbWVUb3BZcy5wdXNoKHRoaXMuJHJlZnMuY29tbWVudC4kZWwub2Zmc2V0VG9wKTsNCiAgICAgIHRoaXMudGhlbWVUb3BZcy5wdXNoKHRoaXMuJHJlZnMucmVjb21tZW5kLiRlbC5vZmZzZXRUb3ApOw0KDQogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnRoZW1lVG9wWXMpDQogICAgfSwNCiAgICAvL+WwhuW9k+WJjeWVhuWTgea3u+WKoOWIsOi0reeJqei9pu+8jOWFiOiOt+WPluS/oeaBr++8jOeEtuWQjua3u+WKoOWIsOi0reeJqei9pg0KICAgIGFkZENhcmQoKXsNCiAgICAgIC8vIDEu6I635Y+W6LSt54mp6L2m6ZyA6KaB5bGV56S655qE5L+h5oGvDQogICAgICBjb25zdCBvYmogPSB7fQ0KICAgICAgb2JqLmltYWdlID0gdGhpcy50b3BJbWFnZXNbMF07DQogICAgICBvYmoudGl0bGUgPSB0aGlzLmdvb2RzLnRpdGxlOw0KICAgICAgb2JqLmRlc2MgPSB0aGlzLmdvb2RzLmRlc2M7DQogICAgICBvYmoucHJpY2UgPSB0aGlzLmdvb2RzLnJlYWxQcmljZTsNCiAgICAgIG9iai5paWQgPSB0aGlzLmlpZDsNCiAgICAgIG9iai5jb3VudCA9IDA7DQogICAgICAvLyBjb25zb2xlLmxvZyhvYmopDQogICAgICANCiAgICAgIC8vMi7lsIbllYblk4HliqDlhaXotK3nianovaYNCiAgICAgIHRoaXMuYWRkQ2FydChvYmopDQogICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpOw0KICAgICAgICB0aGlzLiR0b2FzdC5zaG93KHJlcywyMDAwKQ0KICAgICAgICANCiAgICAgIH0pDQogICAgfSwNCiAgICBjb250ZW50U2Nyb2xsKHBvc2l0aW9uKSB7DQogICAgICB0aGlzLmxpc3RlblNob3dCYWNrKHBvc2l0aW9uKTsNCiAgICAgIGNvbnN0IHBvc2l0aW9uWSA9IC1wb3NpdGlvbi55Ow0KICAgICAgbGV0IGxlbmd0aCA9IHRoaXMudGhlbWVUb3BZcy5sZW5ndGg7DQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7DQogICAgICAgIGlmICgNCiAgICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCAhPT0gaSAmJg0KICAgICAgICAgICgoaSA8IGxlbmd0aCAtIDEgJiYNCiAgICAgICAgICAgIHBvc2l0aW9uWSA+PSB0aGlzLnRoZW1lVG9wWXNbaV0gJiYNCiAgICAgICAgICAgIHBvc2l0aW9uWSA8IHRoaXMudGhlbWVUb3BZc1tpICsgMV0pIHx8DQogICAgICAgICAgICAoaSA9PT0gbGVuZ3RoIC0gMSAmJiBwb3NpdGlvblkgPj0gdGhpcy50aGVtZVRvcFlzW2ldKSkNCiAgICAgICAgKSB7DQogICAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSBpOw0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuY3VycmVudEluZGV4KTsNCiAgICAgICAgICB0aGlzLiRyZWZzLmRldGFpbG5hdi5jdXJyZW50SW5kZXggPSB0aGlzLmN1cnJlbnRJbmRleDsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgLy8gY29uc29sZS5sb2cocG9zaXRpb24pDQogICAgfSwNCiAgICANCiAgfSwNCiAgbW91bnRlZCgpIHt9LA0KICBkZXN0cm95ZWQoKSB7DQogICAgdGhpcy4kYnVzLiRvZmYoIml0ZW1JbWFnZUxvYWQiLCB0aGlzLmhvbWVJdGVtTGlzdGVuZXIpOw0KICB9DQp9Ow0K"},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views/detail","sourcesContent":["<template>\r\n  <div id=\"detail\">\r\n    <detail-nav-bar @titleClick=\"titleClick\" ref=\"detailnav\"></detail-nav-bar>\r\n    <scroll class=\"detail\" ref=\"scroll\" :probe-type=\"3\" @scroll=\"contentScroll\">\r\n      <detail-swiper :top-images=\"topImages\"></detail-swiper>\r\n      <detail-base-info :goods=\"goods\"></detail-base-info>\r\n      <detail-shop-info :shop=\"shop\"></detail-shop-info>\r\n      <detail-goods-info class=\"btn\" :detail-info=\"detailInfo\" @imageLoad=\"imageLoad\"></detail-goods-info>\r\n      <detail-param-info :param-info=\"paramInfo\" ref=\"params\"></detail-param-info>\r\n      <detail-comment-info :comment-info=\"commentInfo\" ref=\"comment\"></detail-comment-info>\r\n      <goods-list :goods=\"recommends\" ref=\"recommend\"></goods-list>\r\n    </scroll>\r\n    <detail-bottom-bar @addCart=\"addCard\">21321</detail-bottom-bar>\r\n    <back-top @click.native=\"backTop\" v-show=\"isShow\"></back-top>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport DetailNavBar from \"./childComps/DetailNavBar\";\r\nimport DetailBottomBar from \"./childComps/DetailButtonbar\";\r\nimport DetailSwiper from \"./childComps/DetailSwiper\";\r\nimport DetailBaseInfo from \"./childComps/DetailBaseInfo\";\r\nimport DetailShopInfo from \"./childComps/DetailShopInfo\";\r\nimport DetailGoodsInfo from \"./childComps/DetailGoodsInfo\";\r\nimport Scroll from \"components/common/scroll/Scroll\";\r\nimport DetailParamInfo from \"./childComps/DetailParamInfo\";\r\nimport DetailCommentInfo from \"./childComps/DetailCommentInfo\";\r\nimport GoodsList from \"components/content/goods/GoodsList\";\r\nimport BackTop from \"components/content/backTop/BackTop\";\r\nimport { mapActions } from 'vuex'\r\nimport { itemListenerMixin, backTopMixin } from \"common/mixin\";\r\nimport {\r\n  getDetail,\r\n  Goods,\r\n  Shop,\r\n  GoodsParam,\r\n  getRecommend\r\n} from \"network/detail\";\r\nexport default {\r\n  name: \"Detail\",\r\n  mixins: [itemListenerMixin, backTopMixin],\r\n  data() {\r\n    return {\r\n      data: \"\",\r\n      iid: null,\r\n      res: null,\r\n      topImages: [],\r\n      goods: {},\r\n      shop: {},\r\n      detailInfo: {},\r\n      paramInfo: {},\r\n      commentInfo: {},\r\n      recommends: [],\r\n      themeTopYs: [],\r\n      currentIndex: 0,\r\n      isFixed: false\r\n    };\r\n  },\r\n  components: {\r\n    DetailNavBar,\r\n    DetailSwiper,\r\n    DetailBaseInfo,\r\n    DetailShopInfo,\r\n    Scroll,\r\n    DetailGoodsInfo,\r\n    DetailParamInfo,\r\n    DetailCommentInfo,\r\n    GoodsList,\r\n    DetailBottomBar,\r\n    BackTop\r\n  },\r\n  created() {\r\n    //1.获取iid\r\n    this.iid = this.$route.query.iid;\r\n\r\n    //2.根据iid获取数据\r\n    getDetail(this.iid).then(res => {\r\n      //3.抽离详情页数据\r\n      // console.log(res);\r\n      const data = res.result;\r\n      //1.获取顶部轮播数据\r\n      this.topImages = data.itemInfo.topImages;\r\n      // console.log(this.topImages)\r\n\r\n      //2.获取商品信息\r\n      this.goods = new Goods(\r\n        data.itemInfo,\r\n        data.columns,\r\n        data.shopInfo.services\r\n      );\r\n\r\n      //3.获取商家信息\r\n      this.shop = new Shop(data.shopInfo);\r\n\r\n      //4.保存商品的详情数据\r\n      this.detailInfo = data.detailInfo;\r\n\r\n      //5.获取参数信息\r\n      this.paramInfo = new GoodsParam(\r\n        data.itemParams.info,\r\n        data.itemParams.rule\r\n      );\r\n\r\n      //6.获取评论信息\r\n      if (data.rate.cRate !== 0) {\r\n        this.commentInfo = data.rate.list[0];\r\n      }\r\n\r\n      //7.请求推荐数据\r\n      getRecommend().then(res => {\r\n        this.recommends = res.data.list;\r\n      });\r\n    });\r\n  },\r\n  methods: {\r\n    ...mapActions(['addCart']),\r\n    /**\r\n     * 返回顶部backtop函数\r\n     */\r\n    titleClick(index) {\r\n      // console.log(index)\r\n      this.$refs.scroll.scrollTo(0, -this.themeTopYs[index], 500);\r\n    },\r\n    imageLoad() {\r\n      this.$refs.scroll.refresh();\r\n      this.themeTopYs.push(0);\r\n      this.themeTopYs.push(this.$refs.params.$el.offsetTop);\r\n      this.themeTopYs.push(this.$refs.comment.$el.offsetTop);\r\n      this.themeTopYs.push(this.$refs.recommend.$el.offsetTop);\r\n\r\n      // console.log(this.themeTopYs)\r\n    },\r\n    //将当前商品添加到购物车，先获取信息，然后添加到购物车\r\n    addCard(){\r\n      // 1.获取购物车需要展示的信息\r\n      const obj = {}\r\n      obj.image = this.topImages[0];\r\n      obj.title = this.goods.title;\r\n      obj.desc = this.goods.desc;\r\n      obj.price = this.goods.realPrice;\r\n      obj.iid = this.iid;\r\n      obj.count = 0;\r\n      // console.log(obj)\r\n      \r\n      //2.将商品加入购物车\r\n      this.addCart(obj)\r\n      .then(res => {\r\n        // console.log(res);\r\n        this.$toast.show(res,2000)\r\n        \r\n      })\r\n    },\r\n    contentScroll(position) {\r\n      this.listenShowBack(position);\r\n      const positionY = -position.y;\r\n      let length = this.themeTopYs.length;\r\n      for (let i = 0; i < length; i++) {\r\n        if (\r\n          this.currentIndex !== i &&\r\n          ((i < length - 1 &&\r\n            positionY >= this.themeTopYs[i] &&\r\n            positionY < this.themeTopYs[i + 1]) ||\r\n            (i === length - 1 && positionY >= this.themeTopYs[i]))\r\n        ) {\r\n          this.currentIndex = i;\r\n          // console.log(this.currentIndex);\r\n          this.$refs.detailnav.currentIndex = this.currentIndex;\r\n        }\r\n      }\r\n      // console.log(position)\r\n    },\r\n    \r\n  },\r\n  mounted() {},\r\n  destroyed() {\r\n    this.$bus.$off(\"itemImageLoad\", this.homeItemListener);\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n#detail {\r\n  height: 100vh;\r\n  /* border: 2px solid red; */\r\n}\r\n.detail {\r\n  position: relative;\r\n  z-index: 9;\r\n  background-color: #ffffff;\r\n  height: calc(100% - 93px);\r\n  /* border: 2px solid red; */\r\n}\r\n\r\n.btn {\r\n  /* margin-top: 10px; */\r\n  /* border: 2px solid red; */\r\n  position: relative;\r\n}\r\n</style>"]}]}